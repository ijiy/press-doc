import{_ as n,c as a,a0 as l,o as p}from"./chunks/framework.Bakaa70P.js";const y=JSON.parse('{"title":"uniapp 内嵌【unity】","description":"","frontmatter":{},"headers":[],"relativePath":"uniapp/gc-android/unity.md","filePath":"uniapp/gc-android/unity.md","lastUpdated":1721206549000}'),e={name:"uniapp/gc-android/unity.md"};function o(t,s,i,c,r,F){return p(),a("div",null,s[0]||(s[0]=[l(`<h1 id="uniapp-内嵌【unity】" tabindex="-1">uniapp 内嵌【unity】 <a class="header-anchor" href="#uniapp-内嵌【unity】" aria-label="Permalink to &quot;uniapp 内嵌【unity】&quot;">​</a></h1><ul><li><p>安卓原生工程的根目录下新建文件夹 <code>UnityProject</code></p></li><li><p>Unity3d 项目重命名为 <code>androidBuild</code> (包含<code>unityLibrary</code>, <code>launcher</code>等), 并移到 <code>UnityProject</code></p></li><li><p>使用和 unity 一致的 NDK</p><ul><li>如: unity 使用的 NDK 文件为<code>android-ndk-r21d</code> (包含<code>python-packages</code>, <code>toolchains</code>等)</li><li>则: local.properties, 添加 <ul><li><code>ndk.dir=...\\\\android-ndk-r21d</code> (路径的写法参照<code>sdk.dir</code>)</li></ul></li></ul></li><li><p>setting.gradle, 添加</p></li></ul><div class="language-gradle line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">gradle</span><pre class="shiki monokai vp-code" tabindex="0"><code><span class="line"><span>include &#39;:unityLibrary&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>project(&#39;:unityLibrary&#39;).projectDir=new File(&#39;UnityProject\\\\androidBuild\\\\unityLibrary&#39;)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>app\\build.gradle <ul><li><code>minSdkVersion</code> 改成和 UnityProject\\androidBuild\\unityLibrary\\build.gradle 对应属性一致的值</li></ul></li></ul><p>添加</p><div class="language-gradle line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">gradle</span><pre class="shiki monokai vp-code" tabindex="0"><code><span class="line"><span>dependencies {</span></span>
<span class="line"><span>  implementation project(&#39;:unityLibrary&#39;)</span></span>
<span class="line"><span>  implementation fileTree(dir: project(&#39;:unityLibrary&#39;).getProjectDir().toString() + (&#39;\\\\libs&#39;), include: [&#39;*.jar&#39;])</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>app\\src\\main\\res\\values\\strings.xml, 添加</li></ul><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki monokai vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#F92672;">string</span><span style="color:#A6E22E;"> name</span><span style="color:#F8F8F2;">=</span><span style="color:#E6DB74;">&quot;game_view_content_description&quot;</span><span style="color:#F8F8F2;">&gt;Game view&lt;/</span><span style="color:#F92672;">string</span><span style="color:#F8F8F2;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="每次更换unity文件-unityproject-androidbuild" tabindex="-1">每次更换unity文件 (UnityProject\\androidBuild) <a class="header-anchor" href="#每次更换unity文件-unityproject-androidbuild" aria-label="Permalink to &quot;每次更换unity文件 (UnityProject\\androidBuild)&quot;">​</a></h2><ul><li><p>UnityProject\\androidBuild\\unityLibrary\\libs</p><ul><li>将除了<code>unity-classes.jar</code>外的所有包拷贝到 app\\libs 下 (没有额外包跳过)</li></ul></li><li><p>UnityProject\\androidBuild\\unityLibrary\\build.gradle</p><ul><li>注释 <code>dependencies</code>除了<code>unity-classes.jar</code>外引入的包 (没有额外包跳过)</li><li>注释 <code>buildToolsVersion</code> (若和 app\\build.gradle 对应属性的值一致, 可跳过)</li><li>注释 <code>noCompress =...</code></li></ul></li><li><p>UnityProject\\androidBuild\\unityLibrary\\src\\main\\AndroidManifest.xml (如果有这个文件存在)</p><ul><li>注释 <code>intent-filter</code> 节点 (否则移动设备桌面会生成两个图标)</li></ul></li></ul><h2 id="uniapp-和-unity-的数据交互" tabindex="-1">uniapp 和 unity 的数据交互 <a class="header-anchor" href="#uniapp-和-unity-的数据交互" aria-label="Permalink to &quot;uniapp 和 unity 的数据交互&quot;">​</a></h2><p>需要中间模块, 中转两者传递的数据</p><ul><li><p>右键根目录 -&gt; New -&gt; Module -&gt; Android Library</p><ul><li>Module name: <code>ModuleName</code> (模块名, 大驼峰格式)</li><li>Package name: <code>com.gsm.modulename</code> (com.公司名.模块名, 参考<a href="./../app-key#包名命名">包名命名</a>)</li><li><code>Finish</code></li></ul></li><li><p>app\\build.gradle 添加</p></li></ul><div class="language-gradle line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">gradle</span><pre class="shiki monokai vp-code" tabindex="0"><code><span class="line"><span>implementation project(&#39;:ModuleName&#39;)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><p>ModuleName\\build.gradle</p><ul><li><code>compileSdk</code> 改成和 app\\build.gradle -&gt; <code>compileSdkVersion</code> 一致的值</li><li><code>minSdk</code> 改成和 app\\build.gradle -&gt; <code>minSdkVersion</code> 一致的值</li></ul></li><li><p>添加, 并注释或删除原本的依赖</p></li></ul><div class="language-gradle line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">gradle</span><pre class="shiki monokai vp-code" tabindex="0"><code><span class="line"><span>dependencies {</span></span>
<span class="line"><span>	implementation project(&#39;:unityLibrary&#39;)</span></span>
<span class="line"><span>    implementation fileTree(dir: project(&#39;:unityLibrary&#39;).getProjectDir().toString() + (&#39;\\\\libs&#39;), include: [&#39;*.jar&#39;])</span></span>
<span class="line"><span></span></span>
<span class="line"><span>	compileOnly &#39;androidx.recyclerview:recyclerview:1.0.0&#39;</span></span>
<span class="line"><span>	compileOnly &#39;androidx.legacy:legacy-support-v4:1.0.0&#39;</span></span>
<span class="line"><span>	compileOnly &#39;androidx.appcompat:appcompat:1.0.0&#39;</span></span>
<span class="line"><span>	compileOnly &#39;com.alibaba:fastjson:1.2.83&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>	compileOnly fileTree(include: [&#39;uniapp-v8-release.aar&#39;], dir: &#39;../app/libs&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>	//    implementation &#39;androidx.appcompat:appcompat:1.6.1&#39;</span></span>
<span class="line"><span>	//    implementation &#39;com.google.android.material:material:1.8.0&#39;</span></span>
<span class="line"><span>	//    testImplementation &#39;junit:junit:4.13.2&#39;</span></span>
<span class="line"><span>	//    androidTestImplementation &#39;androidx.test.ext:junit:1.1.5&#39;</span></span>
<span class="line"><span>	//    androidTestImplementation &#39;androidx.test.espresso:espresso-core:3.5.1&#39;</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ul><li><p>创建插件包</p><ul><li>右键 ModuleName\\src\\main\\java -&gt; New -&gt; Java Class (正常规范是在 \\java\\com\\gsm\\modulename 下创建) <ul><li>输入 类名<code>PluginModuleName</code>, 回车, 即 创建插件包<code>PluginModuleName.java</code></li></ul></li></ul></li><li><p>编写 PluginModuleName.java</p></li></ul><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki monokai vp-code" tabindex="0"><code><span class="line"><span style="color:#F92672;">package</span><span style="color:#F92672;"> com.gsm.modulename</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">import</span><span style="color:#F92672;"> com.alibaba.fastjson.JSONObject</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">import</span><span style="color:#F92672;"> io.dcloud.feature.uniapp.annotation.UniJSMethod</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F92672;">import</span><span style="color:#F92672;"> io.dcloud.feature.uniapp.common.UniModule</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F92672;">import</span><span style="color:#F92672;"> com.unity3d.player.UnityPlayer</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">public</span><span style="color:#F92672;"> class</span><span> </span><span style="color:#A6E22E;text-decoration:underline;">PluginModuleName</span><span style="color:#F92672;"> extends</span><span> </span><span style="color:#A6E22E;font-style:italic;text-decoration:underline;">UniModule</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">    @</span><span style="color:#66D9EF;font-style:italic;">UniJSMethod</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">uiThread</span><span style="color:#F92672;"> =</span><span style="color:#AE81FF;"> true</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#88846F;">    /**</span></span>
<span class="line"><span style="color:#88846F;">     * 调用 unity 的方法</span></span>
<span class="line"><span style="color:#88846F;">     * </span><span style="color:#F92672;">@param</span><span style="color:#FD971F;font-style:italic;"> msg</span><span style="color:#88846F;"> JSON字符串</span></span>
<span class="line"><span style="color:#88846F;">     */</span></span>
<span class="line"><span style="color:#F92672;">    public</span><span style="color:#66D9EF;font-style:italic;"> void</span><span style="color:#A6E22E;"> useUnityMethod</span><span style="color:#F8F8F2;">(</span><span style="color:#66D9EF;font-style:italic;">String</span><span style="color:#FD971F;font-style:italic;"> arg</span><span style="color:#F8F8F2;">) {</span></span>
<span class="line"><span style="color:#F8F8F2;">        UnityPlayer.</span><span style="color:#A6E22E;">UnitySendMessage</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&quot;GameStart&quot;</span><span style="color:#F8F8F2;">, </span><span style="color:#E6DB74;">&quot;Stop&quot;</span><span style="color:#F8F8F2;">, arg);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">        System.out.</span><span style="color:#A6E22E;">println</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&quot;uniapp arg =&gt; &quot;</span><span style="color:#F92672;"> +</span><span style="color:#F8F8F2;"> arg);</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    @</span><span style="color:#66D9EF;font-style:italic;">UniJSMethod</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">uiThread</span><span style="color:#F92672;"> =</span><span style="color:#AE81FF;"> true</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#88846F;">    /**</span></span>
<span class="line"><span style="color:#88846F;">     * 调用 uniapp 的方法</span></span>
<span class="line"><span style="color:#88846F;">     * </span><span style="color:#F92672;">@param</span><span style="color:#FD971F;font-style:italic;"> msg</span><span style="color:#88846F;"> JSON字符串</span></span>
<span class="line"><span style="color:#88846F;">     */</span></span>
<span class="line"><span style="color:#F92672;">    public</span><span style="color:#66D9EF;font-style:italic;"> void</span><span style="color:#A6E22E;"> useUniappMethod</span><span style="color:#F8F8F2;">(</span><span style="color:#66D9EF;font-style:italic;">String</span><span style="color:#FD971F;font-style:italic;"> arg</span><span style="color:#F8F8F2;">) {</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">        JSONObject</span><span style="color:#F8F8F2;"> jsonObj </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> JSONObject.</span><span style="color:#A6E22E;">parseObject</span><span style="color:#F8F8F2;">(arg);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">        mUniSDKInstance.</span><span style="color:#A6E22E;">fireGlobalEventCallback</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&quot;uniappMethod&quot;</span><span style="color:#F8F8F2;">, jsonObj);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">        System.out.</span><span style="color:#A6E22E;">println</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&quot;unity arg =&gt; &quot;</span><span style="color:#F92672;"> +</span><span style="color:#F8F8F2;"> arg);</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><ul><li>注册插件 <ul><li>创建 app\\src\\main\\assets\\dcloud_uniplugins.json <ul><li><code>name</code>, 插件名称, 使用插件时会用到 <code>uni.requireNativePlugin(&#39;ModuleName&#39;)</code></li><li><code>class</code>, 插件指向的插件包 (包名.类名)</li></ul></li></ul></li></ul><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki monokai vp-code" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">{</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">	&quot;nativePlugins&quot;</span><span style="color:#F8F8F2;">: [</span></span>
<span class="line"><span style="color:#F8F8F2;">		{</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">			&quot;plugins&quot;</span><span style="color:#F8F8F2;">: [</span></span>
<span class="line"><span style="color:#F8F8F2;">				{</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">					&quot;type&quot;</span><span style="color:#F8F8F2;">: </span><span style="color:#CFCFC2;">&quot;module&quot;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">					&quot;name&quot;</span><span style="color:#F8F8F2;">: </span><span style="color:#CFCFC2;">&quot;ModuleName&quot;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">					&quot;class&quot;</span><span style="color:#F8F8F2;">: </span><span style="color:#CFCFC2;">&quot;com.gsm.modulename.PluginModuleName&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">				}</span></span>
<span class="line"><span style="color:#F8F8F2;">			]</span></span>
<span class="line"><span style="color:#F8F8F2;">		}</span></span>
<span class="line"><span style="color:#F8F8F2;">	]</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li><p>删除 ModuleName 下的无用文件</p><ul><li>src <ul><li><code>androidTest</code> (测试文件会导致报错)</li><li><code>test</code> (测试文件会导致报错)</li><li>main <ul><li><code>AndroidManifest.xml</code></li><li>java <ul><li><code>com</code></li></ul></li></ul></li></ul></li><li><code>libs</code></li><li><code>.gitignore</code></li></ul></li><li><p>配置混淆文件 ModuleName\\proguard-rules.pro</p></li></ul><div class="language-text line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki monokai vp-code" tabindex="0"><code><span class="line"><span>-keep public class * extends io.dcloud.feature.uniapp.common.UniModule{*;}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><p>如果需要删除模块</p><ul><li>删除 app\\build.gradle -&gt; dependencies 对应的模块依赖</li><li>Project Structure (<code>Ctrl + alt + shift + s</code>) -&gt; Modules <ul><li>选择要删除的模块 -&gt; 点击 模块上方的<code>-</code> -&gt; Yes</li><li>删除模块文件夹</li></ul></li><li>如果直接删除模块文件夹, 然后重新创建模块, 而命名相同, 导致无法创建 <ul><li>删除<code>.idea</code>并重启</li></ul></li></ul></li><li><p>uniapp</p></li></ul><div class="language-vue line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki monokai vp-code" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#F92672;">template</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">	&lt;</span><span style="color:#F92672;">view</span><span style="color:#A6E22E;"> class</span><span style="color:#F8F8F2;">=</span><span style="color:#E6DB74;">&quot;qp-page&quot;</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">		&lt;</span><span style="color:#F92672;">button</span><span style="color:#A6E22E;"> @click</span><span style="color:#F8F8F2;">=</span><span style="color:#E6DB74;">&quot;goActivity()&quot;</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">			打开unity</span></span>
<span class="line"><span style="color:#F8F8F2;">		&lt;/</span><span style="color:#F92672;">button</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">		&lt;</span><span style="color:#F92672;">button</span><span style="color:#A6E22E;"> @click</span><span style="color:#F8F8F2;">=</span><span style="color:#E6DB74;">&quot;testUniappMethod()&quot;</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">			测试unity调用APP的方法</span></span>
<span class="line"><span style="color:#F8F8F2;">		&lt;/</span><span style="color:#F92672;">button</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">		&lt;</span><span style="color:#F92672;">button</span><span style="color:#A6E22E;"> @click</span><span style="color:#F8F8F2;">=</span><span style="color:#E6DB74;">&quot;testUnityMethod()&quot;</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">			测试APP调用unity的方法</span></span>
<span class="line"><span style="color:#F8F8F2;">		&lt;/</span><span style="color:#F92672;">button</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">		&lt;</span><span style="color:#F92672;">view</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">			{{pageData.unityData}}</span></span>
<span class="line"><span style="color:#F8F8F2;">		&lt;/</span><span style="color:#F92672;">view</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">	&lt;/</span><span style="color:#F92672;">view</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">&lt;/</span><span style="color:#F92672;">template</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#F92672;">script</span><span style="color:#A6E22E;"> setup</span><span style="color:#A6E22E;"> lang</span><span style="color:#F8F8F2;">=</span><span style="color:#E6DB74;">&quot;ts&quot;</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F92672;">	import</span><span style="color:#F8F8F2;"> {shallowReactive} </span><span style="color:#F92672;">from</span><span style="color:#E6DB74;"> &#39;vue&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">	interface</span><span> </span><span style="color:#A6E22E;text-decoration:underline;">TSPageData</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#88846F;">		// unity参数</span></span>
<span class="line"><span style="color:#F8F8F2;">		unityData</span><span style="color:#F92672;">:</span><span style="color:#66D9EF;font-style:italic;"> string</span></span>
<span class="line"><span style="color:#F8F8F2;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">	const</span><span style="color:#F8F8F2;"> pageData</span><span style="color:#F92672;">:</span><span> </span><span style="color:#A6E22E;text-decoration:underline;">TSPageData</span><span style="color:#F92672;"> =</span><span style="color:#A6E22E;"> shallowReactive</span><span style="color:#F8F8F2;">(&lt;</span><span style="color:#A6E22E;text-decoration:underline;">TSPageData</span><span style="color:#F8F8F2;">&gt;{</span></span>
<span class="line"><span style="color:#F8F8F2;">		unityData: </span><span style="color:#E6DB74;">&#39;&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">	});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">	const</span><span style="color:#F8F8F2;"> useModuleName </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> uni.</span><span style="color:#A6E22E;">requireNativePlugin</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;ModuleName&#39;</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">	/**</span></span>
<span class="line"><span style="color:#88846F;">	 * 打开unity</span></span>
<span class="line"><span style="color:#88846F;">	 */</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">	const</span><span style="color:#A6E22E;"> goActivity</span><span style="color:#F92672;"> =</span><span style="color:#F8F8F2;"> () </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">		const</span><span style="color:#F8F8F2;"> main </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> plus.android.</span><span style="color:#A6E22E;">runtimeMainActivity</span><span style="color:#F8F8F2;">();</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">		const</span><span style="color:#F8F8F2;"> pIntent</span><span style="color:#F92672;">:</span><span style="color:#66D9EF;font-style:italic;"> any</span><span style="color:#F92672;"> =</span><span style="color:#F8F8F2;"> plus.android.</span><span style="color:#A6E22E;">importClass</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;android.content.Intent&#39;</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">		const</span><span style="color:#F8F8F2;"> nIntent </span><span style="color:#F92672;">=</span><span style="color:#F92672;"> new</span><span style="color:#A6E22E;"> pIntent</span><span style="color:#F8F8F2;">(main.</span><span style="color:#A6E22E;">getIntent</span><span style="color:#F8F8F2;">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">		nIntent.</span><span style="color:#A6E22E;">setClassName</span><span style="color:#F8F8F2;">(main, </span><span style="color:#E6DB74;">&#39;com.unity3d.player.UnityPlayerActivity&#39;</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#F8F8F2;">		nIntent.</span><span style="color:#A6E22E;">setFlags</span><span style="color:#F8F8F2;">(pIntent.FLAG_ACTIVITY_CLEAR_TOP);</span></span>
<span class="line"><span style="color:#F8F8F2;">		main.</span><span style="color:#A6E22E;">startActivity</span><span style="color:#F8F8F2;">(nIntent);</span></span>
<span class="line"><span style="color:#F8F8F2;">	};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">	/**</span></span>
<span class="line"><span style="color:#88846F;">	 * 测试APP调用unity的方法</span></span>
<span class="line"><span style="color:#88846F;">	 */</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">	const</span><span style="color:#A6E22E;"> testUnityMethod</span><span style="color:#F92672;"> =</span><span style="color:#F8F8F2;"> () </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">		useModuleName.</span><span style="color:#A6E22E;">useUnityMethod</span><span style="color:#F8F8F2;">(JSON.</span><span style="color:#A6E22E;">stringify</span><span style="color:#F8F8F2;">({code: </span><span style="color:#E6DB74;">&#39;stop&#39;</span><span style="color:#F8F8F2;">, data: </span><span style="color:#E6DB74;">&#39;告知unity&#39;</span><span style="color:#F8F8F2;">}));</span></span>
<span class="line"><span style="color:#F8F8F2;">	};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">	/**</span></span>
<span class="line"><span style="color:#88846F;">	 * 测试unity调用APP的方法</span></span>
<span class="line"><span style="color:#88846F;">	 */</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">	const</span><span style="color:#A6E22E;"> testUniappMethod</span><span style="color:#F92672;"> =</span><span style="color:#F8F8F2;"> () </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">		useModuleName.</span><span style="color:#A6E22E;">useUniappMethod</span><span style="color:#F8F8F2;">(JSON.</span><span style="color:#A6E22E;">stringify</span><span style="color:#F8F8F2;">({code: </span><span style="color:#E6DB74;">&#39;ready&#39;</span><span style="color:#F8F8F2;">, data: </span><span style="color:#E6DB74;">&#39;告知uniapp&#39;</span><span style="color:#F8F8F2;">}));</span></span>
<span class="line"><span style="color:#F8F8F2;">	};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">	plus.globalEvent.</span><span style="color:#A6E22E;">addEventListener</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;uniappMethod&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#FD971F;font-style:italic;">res</span><span style="color:#66D9EF;font-style:italic;"> =&gt;</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">		pageData.unityData </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> JSON.</span><span style="color:#A6E22E;">stringify</span><span style="color:#F8F8F2;">(res);</span></span>
<span class="line"><span style="color:#F8F8F2;">	});</span></span>
<span class="line"><span style="color:#F8F8F2;">&lt;/</span><span style="color:#F92672;">script</span><span style="color:#F8F8F2;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div>`,24)]))}const d=n(e,[["render",o]]);export{y as __pageData,d as default};
